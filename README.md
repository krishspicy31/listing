# Culturalite

A platform connecting people with cultural events and experiences. Built with Next.js frontend and Django backend in a Turborepo monorepo structure.

## Project Structure

This Turborepo monorepo contains frontend, backend, and testing applications:

```
culturalite/
├── apps/
│   ├── frontend/          # Next.js 14 frontend application
│   └── backend/           # Django 5.0 backend API
├── packages/
│   └── e2e-tests/         # Playwright end-to-end tests
├── src/                   # Shared types and utilities
├── docs/                  # Project documentation
├── turbo.json            # Turborepo configuration
└── package.json          # Root workspace configuration
```

## Quick Start

### Prerequisites

- Node.js 18+ and npm 8+
- Python 3.8+
- Git

### Installation

1. **Clone and install dependencies:**
```bash
git clone <repository-url>
cd culturalite
npm install  # Installs Node.js dependencies
npm run setup:backend  # Installs Python dependencies for backend
```

2. **Configure environment files:**
```bash
# Frontend environment (if template exists)
cd apps/frontend
cp .env.local.template .env.local
cd ../..

# Backend environment (if template exists)
cd apps/backend
cp .env.template .env
cd ../..
```

3. **Run initial database migration:**
```bash
cd apps/backend
python3 manage.py migrate
cd ../..
```

> **Note:** Run `npm run setup:backend` to install Python dependencies for the Django backend when needed.

### Development

**Start all applications in development mode:**
```bash
npm run dev
```

**Or start individual applications:**
```bash
# Frontend only
npm run dev:frontend

# Backend only
npm run dev:backend
```

- Frontend: http://localhost:3000
- Backend API: http://127.0.0.1:8000

## Tech Stack

### Frontend
- Next.js 14.2 with App Router
- TypeScript 5.4
- Tailwind CSS 3.4.1
- shadcn/ui 0.8.0
- Jest & React Testing Library

### Backend
- Django 5.0
- Django REST Framework 3.15
- PostgreSQL (Neon) / SQLite
- JWT Authentication
- Django TestCase

## Turborepo Commands

This project uses [Turborepo](https://turbo.build/) for efficient monorepo management with caching and parallel execution.

### Common Commands

```bash
# Build all packages
npm run build

# Run all packages in development mode
npm run dev

# Run tests across all packages
npm run test

# Run linting across all packages
npm run lint

# Clean all build artifacts
npm run clean
```

### Filtered Commands

Run commands for specific packages using Turborepo filters:

```bash
# Frontend specific
npm run build:frontend
npm run dev:frontend
npm run test:frontend

# Backend specific
npm run build:backend
npm run dev:backend
npm run test:backend

# E2E tests only
npm run test:e2e:only
```

### Advanced Turborepo Usage

```bash
# Run with verbose output
npx turbo build --verbose

# Force rebuild (ignore cache)
npx turbo build --force

# Run in parallel with custom concurrency
npx turbo test --concurrency=4

# Generate dependency graph
npx turbo build --graph

# Run only changed packages
npx turbo build --filter="[HEAD^1]"
```

### Caching

Turborepo automatically caches build outputs and test results. The cache is stored in `.turbo/` and significantly speeds up subsequent runs.

## Development Workflow

1. **Start development servers:**
   ```bash
   npm run dev
   ```

2. **Make changes** to any package

3. **Run tests:**
   ```bash
   npm run test
   ```

4. **Build for production:**
   ```bash
   npm run build
   ```

## Testing

### Run All Tests
```bash
npm run test
```

### Frontend Tests
```bash
npm run test:frontend
# Or with coverage
npm run test:coverage --filter=frontend
```

### Backend Tests
```bash
npm run test:backend
# Or directly in the backend directory
cd apps/backend
python manage.py test tests
```

### E2E Tests
```bash
npm run test:e2e:only
# Or with UI mode
cd packages/e2e-tests
npm run test:ui
```

## Deployment

### Render (Recommended)

This project is configured for easy deployment on Render with both frontend and backend:

#### Option 1: Deploy Both Services Together

1. **Connect your repository** to Render
2. **Use the `render.yaml`** file for automatic service configuration
3. **Set environment variables** as needed
4. **Deploy** - Render will automatically set up both frontend and backend

#### Option 2: Deploy Services Separately

**Frontend:**
- **Build Command**: `npm install && npm run build:frontend`
- **Start Command**: `npm run start --workspace=frontend`
- **Environment**: Node.js

**Backend:**
- **Build Command**: `cd apps/backend && pip install -r requirements.txt && python manage.py migrate && python manage.py collectstatic --noinput`
- **Start Command**: `cd apps/backend && gunicorn culturalite_backend.wsgi:application --bind 0.0.0.0:$PORT`
- **Environment**: Python 3.12

#### Database

- **Development**: SQLite (included)
- **Production**: PostgreSQL (Render managed database)

#### Environment Variables

**Backend:**
- `SECRET_KEY` - Django secret key (auto-generated by Render)
- `DEBUG` - Set to `False` for production
- `ALLOWED_HOSTS` - Your Render domain
- `DATABASE_URL` - Auto-configured by Render
- `CORS_ALLOWED_ORIGINS` - Frontend URL for CORS

**Frontend:**
- `NEXT_PUBLIC_API_URL` - Backend API URL

## Environment Setup

Each application has its own environment configuration:

- Frontend: `.env.local` (see `.env.local.template`)
- Backend: `.env` (see `.env.template`)

## Documentation

Detailed documentation is available in the `docs/` directory:

- Architecture documentation
- API specifications
- Deployment guides
- Development stories

## Contributing

1. Clone the repository
2. Set up both frontend and backend environments
3. Run tests to ensure everything works
4. Make your changes
5. Run tests again
6. Submit a pull request

## License

This project is part of the Culturalite platform development.
